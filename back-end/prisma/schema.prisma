// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator nestgraphql {
  provider = "node node_modules/prisma-nestjs-graphql"
  output = "../src/@generated/prisma-nestjs-graphql"
  fields_Validator_from = "class-validator"
  fields_Validator_input = true
}

model User {
  id          Int @id @default(autoincrement())

  /// @Validator.IsEmail()
  email       String @unique

  name        String @db.VarChar(180)

  /// @Validator.Length(6,10)
  password    String

  /// @Validator.Length(10,11)
  phone       String
  validation  Boolean @default(false)
  role        String
  immobiles   Immobile[]

  @@map("user")
}

model Immobile {
  id          Int @id @default(autoincrement())
  published   Boolean @default(false)
  type        String
  about       String
  vsell       String?
  vboth       String?
  iptu        String
  describe    String
  footage     Int
  bathroom    Int
  vacancy     Int
  address     String
  number      String
  complement  String?
  postalcode  String
  district    String
  state       String
  record      User? @relation(fields: [recordId], references: [id])
  recordId    Int?
  photographs Photograph[]
  owners      ImmobileOnOwner[]

  @@map("immobile")
}

model Photograph {
  id          Int @id @default(autoincrement())
  describe    String @db.VarChar(250)
  url         String
  immobile    Immobile? @relation(fields: [immobileId], references: [id])
  immobileId  Int?

  @@map("photograph")
}

model Owner {
  id          Int @id @default(autoincrement())
  name        String
  email       String @unique
  phone       String
  immobiles   ImmobileOnOwner[]

  @@map("owner")
}

model ImmobileOnOwner {
  immobile    Immobile @relation(fields: [immobileId], references: [id])
  immobileId  Int
  owner       Owner @relation(fields: [ownerId], references: [id])
  ownerId     Int

  @@id([immobileId, ownerId])

  @@map("immobileonowner")
}
